<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador TANGO STOCK - Nivel Experto</title>
    <style>
        /* --- ESTILOS TANGO AI (Actualizados) --- */
        body { font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background-color: #e9ecef; margin: 0; padding: 0; color: #333; height: 100vh; overflow: hidden; font-size: 13px; }
        
        /* Barra Superior */
        .top-bar { background: #fff; height: 48px; border-bottom: 1px solid #ccc; display: flex; align-items: center; padding: 0 20px; box-shadow: 0 1px 4px rgba(0,0,0,0.1); z-index: 100; position:relative; }
        .logo { font-weight: 700; font-size: 20px; color: #2b579a; margin-right: 20px; cursor: pointer; display:flex; align-items:center; gap:5px; }
        .breadcrumb { color: #666; font-size: 13px; border-left: 1px solid #ccc; padding-left: 15px; margin-left: 15px; height: 20px; display: flex; align-items: center; }
        
        /* Contenedores */
        .view-section { display: none; height: calc(100vh - 50px); overflow-y: auto; padding: 20px; box-sizing: border-box; }
        .view-section.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* MENU PRINCIPAL */
        .menu-header { text-align: center; margin-bottom: 40px; margin-top: 20px; }
        .menu-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 25px; max-width: 1100px; margin: 0 auto; }
        .menu-card { background: white; border: 1px solid #ddd; border-radius: 6px; overflow: hidden; transition: all 0.2s; cursor: pointer; position: relative; }
        .menu-card:hover { transform: translateY(-5px); box-shadow: 0 10px 25px rgba(0,0,0,0.1); border-color: #2b579a; }
        .card-top { height: 6px; background: #ddd; }
        .menu-card:nth-child(1) .card-top { background: #4cd137; }
        .menu-card:nth-child(2) .card-top { background: #fbc531; }
        .menu-card:nth-child(3) .card-top { background: #e84118; }
        /* Color espec√≠fico para la tarjeta del juego */
        .menu-card.game-card .card-top { background: #8e44ad; } 
        
        .card-content { padding: 25px; }
        .card-title { font-size: 18px; font-weight: 700; margin-bottom: 10px; color: #333; }
        .card-desc { color: #666; font-size: 14px; line-height: 1.5; margin-bottom: 20px; min-height: 60px; }
        .btn-start { background: #2b579a; color: white; border: none; padding: 8px 0; width: 100%; border-radius: 4px; font-weight: 600; cursor: pointer; }
        .btn-start:hover { background: #1e3c6b; }

        /* CAJA DE CONSIGNA (NUEVO) */
        .scenario-box { background: #fff3cd; border: 1px solid #ffeeba; color: #856404; padding: 15px; border-radius: 5px; margin-bottom: 20px; font-size: 13px; max-width: 950px; margin-left: auto; margin-right: auto; display: flex; gap: 15px; align-items: flex-start; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .scenario-icon { font-size: 24px; }
        .scenario-text strong { display: block; margin-bottom: 5px; color: #533f03; }
        .scenario-list { margin: 5px 0 0 20px; padding: 0; }
        .scenario-list li { margin-bottom: 3px; }

        /* FORMULARIOS TANGO WEB */
        .tango-container { background: #fff; border: 1px solid #ccc; max-width: 950px; margin: 0 auto 40px; border-radius: 4px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .entity-header { padding: 15px 20px; border-bottom: 1px solid #eee; display: flex; align-items: center; gap: 10px; }
        .entity-title { font-size: 16px; font-weight: 600; color: #333; }
        
        .action-bar { padding: 8px 20px; background: #fcfcfc; border-bottom: 1px solid #ddd; display: flex; gap: 6px; }
        .btn-toolbar { padding: 6px 15px; border: 1px solid transparent; border-radius: 3px; font-size: 12px; font-weight: 600; cursor: pointer; }
        .btn-accept { background: #28a745; color: white; border-color: #218838; }
        .btn-accept:hover { background: #218838; }
        .btn-cancel { background: #dc3545; color: white; border-color: #c82333; }
        .btn-help { background: #fff; border-color: #ccc; color: #333; }

        .tabs { display: flex; background: #f8f9fa; border-bottom: 1px solid #ddd; padding-left: 10px; margin-top: 10px; }
        .tab { padding: 10px 20px; cursor: pointer; color: #666; border: 1px solid transparent; border-bottom: none; margin-bottom: -1px; font-size: 12px; }
        .tab.active { background: #fff; border-color: #ddd; border-bottom-color: #fff; color: #2b579a; border-top: 2px solid #2b579a; font-weight: 600; }

        .form-body { padding: 25px; display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
        .full-width { grid-column: 1 / -1; }
        
        .form-group { margin-bottom: 15px; }
        .label { display: block; margin-bottom: 5px; font-weight: 600; color: #555; font-size: 12px; }
        .input, .select { width: 100%; padding: 7px; border: 1px solid #ccc; border-radius: 3px; font-size: 12px; box-sizing: border-box; transition: border 0.2s; }
        .input:focus, .select:focus { border-color: #2b579a; outline: none; }
        .input:disabled { background: #f0f0f0; color: #888; }

        /* Checkboxes estilizados */
        .check-list { display: flex; flex-direction: column; gap: 8px; margin-top: 5px; }
        .check-item { display: flex; align-items: center; font-size: 12px; cursor: pointer; }
        .check-item input { margin-right: 8px; accent-color: #2b579a; }

        /* VENTANA FLOTANTE (NIVEL 3) */
        .window-wrap { max-width: 950px; margin: 0 auto; background: white; border: 1px solid #999; box-shadow: 0 10px 40px rgba(0,0,0,0.2); border-radius: 4px; overflow: hidden; }
        .window-title-bar { background: linear-gradient(180deg, #eef2f8 0%, #d3deed 100%); padding: 6px 10px; border-bottom: 1px solid #a0a0a0; display: flex; justify-content: space-between; align-items: center; }
        .window-toolbar { background: #f5f5f5; padding: 5px; border-bottom: 1px solid #ddd; display: flex; gap: 10px; }
        .tool-btn { width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; border: 1px solid transparent; border-radius: 3px; cursor: pointer; font-size: 16px; }
        .tool-btn:hover { border-color: #ccc; background: #e6e6e6; }
        
        .grid-table { width: 100%; border-collapse: collapse; font-size: 12px; margin-top: 10px; border: 1px solid #bbb; background: #fff; }
        .grid-table th { background: #e6e6e6; border: 1px solid #bbb; padding: 6px; text-align: left; font-weight: 600; color: #333; }
        .grid-table td { border: 1px solid #eee; padding: 0; }
        .grid-input { width: 100%; border: none; padding: 6px; box-sizing: border-box; font-family: inherit; font-size: 12px; }
        .grid-input:focus { background: #e8f0fe; outline: 2px solid #2b579a; }

        /* FEEDBACK MODAL */
        .overlay { position: fixed; top:0; left:0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; display: none; justify-content: center; align-items: center; }
        .modal { background: white; width: 450px; padding: 0; border-radius: 8px; box-shadow: 0 20px 50px rgba(0,0,0,0.3); overflow: hidden; animation: popIn 0.3s; }
        @keyframes popIn { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .modal-header { padding: 15px 20px; border-bottom: 1px solid #eee; font-weight: 700; font-size: 16px; }
        .modal-header.success { background: #d4edda; color: #155724; }
        .modal-header.error { background: #f8d7da; color: #721c24; }
        .modal-body { padding: 20px; font-size: 14px; line-height: 1.5; color: #444; }
        .modal-footer { padding: 15px; background: #f8f9fa; text-align: right; border-top: 1px solid #eee; }
    </style>
</head>
<body>

    <!-- TOP BAR -->
    <div class="top-bar">
        <div class="logo" onclick="showMenu()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="#2b579a"><path d="M12 2L2 7l10 5 10-5-10-5zm0 9l2.5-1.25L12 8.5l-2.5 1.25L12 11zm0 2.5l-5-2.5-5 2.5L12 22l10-8.5-5-2.5-5 2.5z"/></svg>
            TANGO STOCK
        </div>
        <div class="breadcrumb" id="breadText">Inicio</div>
    </div>

    <!-- MENU PRINCIPAL -->
    <div id="view-menu" class="view-section active">
        <div class="menu-header">
            <h1 style="color:#333; margin-bottom: 10px;">Simulador de Pr√°ctica: M√≥dulo Stock</h1>
            <p style="color:#666;">Seleccione un ejercicio para demostrar sus conocimientos.</p>
        </div>

        <div class="menu-grid">
            <!-- Nivel 1 -->
            <div class="menu-card" onclick="loadLevel(1)">
                <div class="card-top"></div>
                <div class="card-content">
                    <div class="card-title">Nivel 1: Tipos de Comprobante</div>
                    <div class="card-desc">
                        Configure un nuevo tipo de comprobante para gestionar <strong>Muestras y Regalos</strong> de proveedores.
                    </div>
                    <button class="btn-start">Iniciar Configuraci√≥n</button>
                </div>
            </div>

            <!-- Nivel 2 -->
            <div class="menu-card" onclick="loadLevel(2)">
                <div class="card-top"></div>
                <div class="card-content">
                    <div class="card-title">Nivel 2: Talonarios</div>
                    <div class="card-desc">
                        La empresa necesita un talonario para movimientos <strong>Internos</strong> entre el Showroom y el Dep√≥sito.
                    </div>
                    <button class="btn-start">Iniciar Alta</button>
                </div>
            </div>

            <!-- Nivel 3 -->
            <div class="menu-card" onclick="loadLevel(3)">
                <div class="card-top"></div>
                <div class="card-content">
                    <div class="card-title">Nivel 3: Operaci√≥n de Ingreso</div>
                    <div class="card-desc">
                        Registre una <strong>Factura de Compra</strong> de un proveedor real. Atenci√≥n a los dep√≥sitos, precios y cantidades.
                    </div>
                    <button class="btn-start">Iniciar Operaci√≥n</button>
                </div>
            </div>

            <!-- JUEGO (CORREGIDO: Ahora est√° fuera del div del Nivel 3) -->
            <div class="menu-card game-card" onclick="window.location.href='juego.html'">
                <div class="card-top"></div> 
                <div class="card-content">
                    <div class="card-title">Desaf√≠o: El Auditor üéÆ</div>
                    <div class="card-desc">
                        ¬°Pon a prueba tu velocidad! <br>
                        Aprueba o rechaza operaciones incorrectas antes de que se acabe el tiempo.
                    </div>
                    <button class="btn-start" style="background: #8e44ad;">JUGAR AHORA</button>
                </div>
            </div>

        </div>
    </div>

    <!-- NIVEL 1: CONFIGURACION COMPROBANTE -->
    <div id="view-level1" class="view-section">
        <div class="scenario-box">
            <div class="scenario-icon">üí°</div>
            <div class="scenario-text">
                <strong>Caso de Uso: "Muestras de Proveedores"</strong>
                El proveedor "Samsung" nos env√≠a mercader√≠a de demostraci√≥n (Dummies) a costo cero. 
                <ul>
                    <li>Cree el comprobante con c√≥digo <strong>MUE</strong>.</li>
                    <li><strong>Requisito:</strong> El stock debe aumentar f√≠sicamente, pero <strong>NO</strong> debe afectar nuestro Precio Promedio Ponderado (PPP) ni costos.</li>
                    <li>Asocie el talonario de "Ajustes".</li>
                </ul>
            </div>
        </div>

        <div class="tango-container">
            <div class="entity-header">
                <span style="font-size:20px">üìÑ</span>
                <div class="entity-title">Tipos de comprobante: NUEVO</div>
            </div>
            <div class="action-bar">
                <button class="btn-toolbar btn-accept" onclick="checkL1()">Aceptar</button>
                <button class="btn-toolbar btn-cancel" onclick="showMenu()">Cancelar</button>
                <button class="btn-toolbar btn-help">Ayuda</button>
            </div>
            
            <div class="tabs">
                <div class="tab active">Principal</div>
                <div class="tab">Observaciones</div>
                <div class="tab">Campos adicionales</div>
            </div>

            <div class="form-body">
                <div class="form-group">
                    <label class="label">C√≥digo</label>
                    <input class="input" value="MUE" disabled>
                </div>
                <div class="form-group">
                    <label class="label">Descripci√≥n</label>
                    <input class="input" value="MUESTRAS / REGALOS PROV.">
                </div>

                <div class="form-group">
                    <label class="label">Tipo de movimiento</label>
                    <select id="l1_mov" class="select">
                        <option value="0">Seleccione...</option>
                        <option value="E">Entrada</option>
                        <option value="S">Salida</option>
                        <option value="T">Transferencia</option>
                        <option value="I">Inventario</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="label">Talonario asociado</label>
                    <select id="l1_tal" class="select">
                        <option value="0">Seleccione...</option>
                        <option value="1">1 - INGRESOS DE COMPRA</option>
                        <option value="5">5 - AJUSTES DE STOCK</option>
                        <option value="2">2 - EGRESOS</option>
                    </select>
                </div>

                <div class="full-width" style="border-top:1px solid #eee; padding-top:10px;">
                    <label class="label" style="color:#2b579a; margin-bottom:10px;">Comportamiento</label>
                    <div style="display:grid; grid-template-columns: 1fr 1fr 1fr;">
                        <div class="check-list">
                            <label class="check-item"><input type="checkbox" id="l1_val"> Valorizado</label>
                            <label class="check-item"><input type="checkbox" id="l1_stk" checked> Actualiza Stock</label>
                        </div>
                        <div class="check-list">
                            <label class="check-item"><input type="checkbox" id="l1_sub"> Genera Asiento Contable</label>
                            <label class="check-item"><input type="checkbox" id="l1_cero"> Permite Precio Cero</label>
                        </div>
                        <div class="check-list">
                            <label class="check-item"><input type="checkbox" checked disabled> Admite reingreso serie</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- NIVEL 2: TALONARIOS -->
    <div id="view-level2" class="view-section">
        <div class="scenario-box">
            <div class="scenario-icon">üî¢</div>
            <div class="scenario-text">
                <strong>Caso de Uso: "Movimientos Internos"</strong>
                Configure el talonario <strong>50</strong> para usar en traslados internos (No Fiscales).
                <ul>
                    <li><strong>Tipo de Letra:</strong> Seleccione la adecuada para movimientos internos (No es A ni B).</li>
                    <li><strong>Numeraci√≥n:</strong> Queremos control estricto. El sistema debe numerar solo (autom√°tico) empezando del 1.</li>
                    <li><strong>Sucursal:</strong> Asocie a la Sucursal "00001 - Casa Central".</li>
                </ul>
            </div>
        </div>

        <div class="tango-container">
            <div class="entity-header">
                <span style="font-size:20px">üî¢</span>
                <div class="entity-title">Talonarios: 50 - TRASLADOS INTERNOS</div>
            </div>
            <div class="action-bar">
                <button class="btn-toolbar btn-accept" onclick="checkL2()">Aceptar</button>
                <button class="btn-toolbar btn-cancel" onclick="showMenu()">Cancelar</button>
            </div>
            
            <div class="tabs">
                <div class="tab active">Principal</div>
                <div class="tab">Impresi√≥n</div>
            </div>

            <div class="form-body">
                <div class="form-group">
                    <label class="label">C√≥digo</label>
                    <input class="input" value="50" disabled>
                </div>
                <div class="form-group">
                    <label class="label">Sucursal asociada</label>
                    <select id="l2_suc" class="select">
                        <option value="0">Seleccione...</option>
                        <option value="1">00001 - Casa Central</option>
                        <option value="2">00002 - Dep√≥sito Norte</option>
                        <option value="9">00099 - Administraci√≥n</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="label">Tipo de Talonario / Letra</label>
                    <select id="l2_letra" class="select">
                        <option value="0">Seleccione...</option>
                        <option value="A">A (Responsable Inscripto)</option>
                        <option value="B">B (Consumidor Final)</option>
                        <option value="M">M (Responsable Monotributo)</option>
                        <option value="X">X (Remito / Interno)</option>
                        <option value="R">R (Remito Oficial)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="label">Destino de impresi√≥n</label>
                    <select class="select">
                        <option>Impresora Predeterminada</option>
                        <option>PDF</option>
                    </select>
                </div>

                <div class="full-width" style="border-top:1px solid #eee; padding-top:10px;">
                    <label class="label" style="color:#2b579a;">Configuraci√≥n de Numeraci√≥n</label>
                    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px; margin-top:10px;">
                        <div class="check-list">
                            <label class="check-item"><input type="checkbox" id="l2_edita"> Edita n√∫mero de comprobante</label>
                            <label class="check-item"><input type="checkbox"> Controla correlatividad fechas</label>
                        </div>
                        <div>
                            <label class="label">Pr√≥ximo n√∫mero a emitir</label>
                            <input type="number" id="l2_prox" class="input" placeholder="Ej: 00000001">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- NIVEL 3: OPERACION -->
    <div id="view-level3" class="view-section">
        <div class="scenario-box">
            <div class="scenario-icon">üõí</div>
            <div class="scenario-text">
                <strong>Caso de Uso: "Factura de Compra"</strong>
                Ingrese la factura f√≠sica que tiene en mano con los siguientes datos:
                <ul>
                    <li><strong>Proveedor:</strong> DISTRIBUIDORA ELECTRO S.A.</li>
                    <li><strong>Comprobante:</strong> Factura de Compra (Valoriza). Nro: <strong>A0001-00001234</strong>.</li>
                    <li><strong>Dep√≥sito Destino:</strong> 01 - CASA CENTRAL (Aqu√≠ vendemos).</li>
                    <li><strong>Art√≠culo:</strong> 10 unidades de "HELADERA SAMSUNG".</li>
                    <li><strong>Costo Unitario:</strong> $ 850.000 (Pesos).</li>
                </ul>
            </div>
        </div>

        <div class="window-wrap">
            <div class="window-title-bar">
                <div style="font-weight:bold; font-size:12px; color:#444">üñ• INGRESOS DE STOCK (SUPERVISOR)</div>
                <div style="font-size:10px; color:#666">Empresa Ejemplo</div>
            </div>
            <div class="window-toolbar">
                <button class="tool-btn" style="color:#28a745" title="F10" onclick="checkL3()">‚úî</button>
                <button class="tool-btn" style="color:#dc3545" onclick="showMenu()">‚úñ</button>
                <div style="width:1px; background:#ccc; margin:0 5px;"></div>
                <button class="tool-btn">‚öô</button>
            </div>
            
            <div style="padding:20px;">
                <!-- CABECERA COMPROBANTE -->
                <div style="display:grid; grid-template-columns: 1fr 1fr 1fr; gap:15px; margin-bottom:20px; background:#f9f9f9; padding:10px; border:1px solid #eee;">
                    <div>
                        <label class="label">Tipo Comprobante</label>
                        <select id="l3_tipo" class="input">
                            <option value="0">...</option>
                            <option value="AJU">AJU - AJUSTE STOCK</option>
                            <option value="FAC">FAC - FACTURA COMPRA</option>
                            <option value="REM">REM - REMITO INGRESO</option>
                        </select>
                    </div>
                    <div>
                        <label class="label">Nro. Comprobante</label>
                        <input id="l3_nro" class="input" placeholder="X0000-00000000">
                    </div>
                    <div>
                        <label class="label">Proveedor</label>
                        <select id="l3_prov" class="input">
                            <option value="0">Seleccione...</option>
                            <option value="100">SAMSUNG ELECTRONICS</option>
                            <option value="200">DISTRIBUIDORA ELECTRO S.A.</option>
                            <option value="300">FLETES Y LOGISTICA</option>
                        </select>
                    </div>
                    <div>
                        <label class="label">Dep√≥sito Destino</label>
                        <input id="l3_dep" class="input" style="width:50px" placeholder="00"> <span style="font-size:11px; color:#666"> (00-99)</span>
                    </div>
                    <div>
                        <label class="label">Moneda</label>
                        <select class="input" disabled><option>1 - $ PESOS</option></select>
                    </div>
                    <div>
                        <label class="label">Cotizaci√≥n</label>
                        <input class="input" value="1.0000" disabled>
                    </div>
                </div>

                <!-- GRILLA ARTICULOS -->
                <table class="grid-table">
                    <thead>
                        <tr>
                            <th style="width:120px">C√≥digo</th>
                            <th>Descripci√≥n</th>
                            <th style="width:60px">Cant.</th>
                            <th style="width:100px">Precio Unit.</th>
                            <th style="width:100px">Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><input class="grid-input" value="HEL-SAM-INV" title="HELADERA SAMSUNG"></td>
                            <td><input class="grid-input" value="Heladera Samsung Inverter 400L" disabled style="background:#f5f5f5"></td>
                            <td><input id="l3_cant" type="number" class="grid-input" placeholder="0"></td>
                            <td><input id="l3_precio" type="number" class="grid-input" placeholder="0.00"></td>
                            <td><input class="grid-input" value="0.00" disabled style="background:#f5f5f5"></td>
                        </tr>
                        <tr>
                            <td><input class="grid-input"></td>
                            <td><input class="grid-input" disabled style="background:#f5f5f5"></td>
                            <td><input class="grid-input" disabled></td>
                            <td><input class="grid-input" disabled></td>
                            <td><input class="grid-input" disabled style="background:#f5f5f5"></td>
                        </tr>
                    </tbody>
                </table>
                <div style="text-align:right; margin-top:10px; font-weight:bold; color:#2b579a">
                    TOTAL COMPROBANTE: $ <span id="l3_total">0.00</span>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL FEEDBACK -->
    <div class="overlay" id="modal">
        <div class="modal">
            <div class="modal-header" id="mHeader">Resultado</div>
            <div class="modal-body" id="mBody">Mensaje...</div>
            <div class="modal-footer">
                <button class="btn-toolbar" onclick="closeModal()">Cerrar y Corregir</button>
                <button class="btn-toolbar btn-accept" id="btnExit" onclick="showMenu()" style="display:none">Volver al Men√∫</button>
            </div>
        </div>
    </div>

    <script>
        // --- NAVEGACION ---
        function showMenu(){
            document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
            document.getElementById('view-menu').classList.add('active');
            document.getElementById('breadText').innerText = "Inicio";
        }
        function loadLevel(lvl){
            document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
            document.getElementById('view-level'+lvl).classList.add('active');
            
            let names = ["", "Configuraci√≥n Comprobantes", "Alta de Talonarios", "Ingreso de Stock"];
            document.getElementById('breadText').innerText = names[lvl];
            resetForms(lvl);
        }
        function resetForms(lvl){
            // Limpiar formularios al entrar
            if(lvl===1){
                document.getElementById('l1_mov').value = '0';
                document.getElementById('l1_tal').value = '0';
                document.getElementById('l1_val').checked = false;
                document.getElementById('l1_sub').checked = false;
                document.getElementById('l1_cero').checked = false;
            }
            if(lvl===2){
                document.getElementById('l2_suc').value = '0';
                document.getElementById('l2_letra').value = '0';
                document.getElementById('l2_edita').checked = false;
                document.getElementById('l2_prox').value = '';
            }
            if(lvl===3){
                document.getElementById('l3_tipo').value = '0';
                document.getElementById('l3_nro').value = '';
                document.getElementById('l3_prov').value = '0';
                document.getElementById('l3_dep').value = '';
                document.getElementById('l3_cant').value = '';
                document.getElementById('l3_precio').value = '';
            }
        }

        // --- MODAL ---
        function showFeedback(success, title, msg){
            const m = document.getElementById('modal');
            const h = document.getElementById('mHeader');
            const b = document.getElementById('mBody');
            const btn = document.getElementById('btnExit');

            m.style.display = 'flex';
            h.innerText = title;
            b.innerHTML = msg;
            
            if(success){
                h.className = 'modal-header success';
                btn.style.display = 'inline-block';
            } else {
                h.className = 'modal-header error';
                btn.style.display = 'none';
            }
        }
        function closeModal(){
            document.getElementById('modal').style.display = 'none';
        }

        // --- LOGICA NIVEL 1 ---
        function checkL1(){
            const mov = document.getElementById('l1_mov').value;
            const tal = document.getElementById('l1_tal').value;
            const val = document.getElementById('l1_val').checked;
            const sub = document.getElementById('l1_sub').checked;
            const cero = document.getElementById('l1_cero').checked;

            let errors = [];
            if(mov !== 'E') errors.push("El tipo de movimiento debe ser 'Entrada' para aumentar stock.");
            if(val) errors.push("No debe ser 'Valorizado' si el costo es cero (bajar√≠a el PPP).");
            if(tal !== '5') errors.push("El talonario correcto para ajustes/muestras es el 5 (Ajustes).");
            if(sub) errors.push("Las muestras gratis no suelen generar asiento contable de compra (no hay factura fiscal).");
            if(!cero) errors.push("Debes habilitar 'Permite Precio Cero', ya que son gratis.");

            if(errors.length === 0) showFeedback(true, "¬°Configuraci√≥n Perfecta!", "Has creado correctamente un comprobante para ingresar muestras sin distorsionar los costos de la empresa.");
            else showFeedback(false, "Atenci√≥n a los detalles", "<ul><li>" + errors.join("</li><li>") + "</li></ul>");
        }

        // --- LOGICA NIVEL 2 ---
        function checkL2(){
            const suc = document.getElementById('l2_suc').value;
            const letra = document.getElementById('l2_letra').value;
            const edita = document.getElementById('l2_edita').checked;
            const prox = document.getElementById('l2_prox').value;

            let errors = [];
            if(letra !== 'X') errors.push("Para movimientos internos NO fiscales se usa la letra X.");
            if(suc !== '1') errors.push("La consigna ped√≠a asociar a Casa Central (Sucursal 1).");
            if(edita) errors.push("Queremos control estricto: La numeraci√≥n debe ser autom√°tica (No editable).");
            if(parseInt(prox) !== 1) errors.push("La numeraci√≥n debe iniciar en 1.");

            if(errors.length === 0) showFeedback(true, "¬°Talonario Creado!", "El sistema ahora puede gestionar movimientos internos con numeraci√≥n autom√°tica X.");
            else showFeedback(false, "Error en par√°metros", "<ul><li>" + errors.join("</li><li>") + "</li></ul>");
        }

        // --- LOGICA NIVEL 3 ---
        function checkL3(){
            const tipo = document.getElementById('l3_tipo').value;
            const nro = document.getElementById('l3_nro').value.trim();
            const prov = document.getElementById('l3_prov').value;
            const dep = document.getElementById('l3_dep').value;
            const cant = document.getElementById('l3_cant').value;
            const precio = document.getElementById('l3_precio').value;

            let errors = [];
            
            // Validaciones trampas
            if(tipo !== 'FAC') errors.push("Debes seleccionar FAC (Factura) para que valorice el stock.");
            if(prov !== '200') errors.push("El proveedor es 'Distribuidora Electro', no el fabricante (Samsung).");
            
            // Validaci√≥n formato Nro Comprobante (Regex simple)
            if(nro !== 'A0001-00001234') errors.push("El n√∫mero de comprobante no coincide con la factura f√≠sica (A0001-00001234).");
            
            if(dep !== '01') errors.push("El dep√≥sito destino debe ser 01 (Casa Central).");
            if(cant != 10) errors.push("La cantidad facturada son 10 unidades.");
            if(precio != 850000) errors.push("El costo unitario debe ser 850000.");

            if(errors.length === 0) showFeedback(true, "¬°Ingreso Exitoso!", "La factura ha sido procesada. El stock aument√≥ y los costos se actualizaron.");
            else showFeedback(false, "Datos Incorrectos", "Revisa los datos contra la 'Factura F√≠sica' del caso:<br><ul><li>" + errors.join("</li><li>") + "</li></ul>");
        }
    </script>
</body>
</html>